# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API –¥–ª—è Scrum Poker

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Google Sheets API.

## –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Cloud Console](https://console.cloud.google.com/)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π Google –∞–∫–∫–∞—É–Ω—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π:
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏
   - –ù–∞–∂–º–∏—Ç–µ "–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç"
   - –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Scrum Poker App")
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å"

## –®–∞–≥ 2: –í–∫–ª—é—á–µ–Ω–∏–µ Google Sheets API

1. –í –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ "API –∏ —Å–µ—Ä–≤–∏—Å—ã" ‚Üí "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞"
2. –ù–∞–π–¥–∏—Ç–µ "Google Sheets API"
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ –∏ –Ω–∞–∂–º–∏—Ç–µ "–í–∫–ª—é—á–∏—Ç—å"

## –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ API –∫–ª—é—á–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "API –∏ —Å–µ—Ä–≤–∏—Å—ã" ‚Üí "–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
2. –ù–∞–∂–º–∏—Ç–µ "+ –°–û–ó–î–ê–¢–¨ –£–ß–ï–¢–ù–´–ï –î–ê–ù–ù–´–ï" ‚Üí "–ö–ª—é—á API"
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π API –∫–ª—é—á
4. (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –∫–ª—é—á:
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–ª—é—á –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –í —Ä–∞–∑–¥–µ–ª–µ "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API" –≤—ã–±–µ—Ä–∏—Ç–µ "–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–ª—é—á"
   - –í—ã–±–µ—Ä–∏—Ç–µ "Google Sheets API"
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## –®–∞–≥ 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Google Sheets

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Sheets](https://sheets.google.com/)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É —Ç–∞–±–ª–∏—Ü—É –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é
3. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º **"scrum-poker"** (—Ç–æ—á–Ω–æ –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ)
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø:
   - –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞" (–∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è")
   - –ù–∞–∂–º–∏—Ç–µ "–ò–∑–º–µ–Ω–∏—Ç—å" —Ä—è–¥–æ–º —Å "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø"
   - –í—ã–±–µ—Ä–∏—Ç–µ "–í—Å–µ, —É –∫–æ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞"
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ "–ß–∏—Ç–∞—Ç–µ–ª—å"
   - –ù–∞–∂–º–∏—Ç–µ "–ì–æ—Ç–æ–≤–æ"

## –®–∞–≥ 5: –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–∞–±–ª–∏—Ü—ã

–ò–∑ URL –≤–∞—à–µ–π Google —Ç–∞–±–ª–∏—Ü—ã –∏–∑–≤–ª–µ–∫–∏—Ç–µ ID:
```
https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit#gid=0
```

–ì–¥–µ `SPREADSHEET_ID` - —ç—Ç–æ —Ç–æ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ.

–ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ URL:
```
https://docs.google.com/spreadsheets/d/19-9wj5utmM3NMNGkUIu1vMPvTDczJC7D1eT9KyAZQIE/edit#gid=599470677
```

ID —Ç–∞–±–ª–∏—Ü—ã: `19-9wj5utmM3NMNGkUIu1vMPvTDczJC7D1eT9KyAZQIE`

## –®–∞–≥ 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `script.js` –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `SHEETS_CONFIG`:

```javascript
const SHEETS_CONFIG = {
    // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ ID –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã
    SPREADSHEET_ID: '19-9wj5utmM3NMNGkUIu1vMPvTDczJC7D1eT9KyAZQIE',
    // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à API –∫–ª—é—á
    API_KEY: 'YOUR_GOOGLE_SHEETS_API_KEY',
    RANGE: 'scrum-poker!A:F',
    UPDATE_INTERVAL: 3000
};
```

–ó–∞–º–µ–Ω–∏—Ç–µ:
- `SPREADSHEET_ID` –Ω–∞ ID –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã
- `API_KEY` –Ω–∞ –≤–∞—à API –∫–ª—é—á –∏–∑ —à–∞–≥–∞ 3

## –®–∞–≥ 7: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Google Sheets –∑–∞–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `script.js`:

### –§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏ –≤ Google Sheets:

```javascript
async function syncToSheets() {
    if (!currentSession || !currentPlayer) return;
    
    updateSyncStatus('syncing', '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');
    
    try {
        const dataToWrite = [
            [currentSession, currentPlayer.id, currentPlayer.name, 
             JSON.stringify(currentPlayer.vote || ''), 
             sessionData.task, sessionData.isRevealed ? 'true' : 'false']
        ];
        
        const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${SHEETS_CONFIG.SPREADSHEET_ID}/values/${SHEETS_CONFIG.RANGE}:append?valueInputOption=RAW&key=${SHEETS_CONFIG.API_KEY}`,
            {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    values: dataToWrite
                })
            }
        );
        
        if (response.ok) {
            updateSyncStatus('synced', '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
        } else {
            throw new Error('–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ Sheets');
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
        updateSyncStatus('error', '–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
        
        // Fallback –∫ localStorage
        const storageKey = `scrumPoker_${currentSession}`;
        // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ localStorage
    }
}
```

### –§—É–Ω–∫—Ü–∏—è —á—Ç–µ–Ω–∏—è –∏–∑ Google Sheets:

```javascript
async function syncFromSheets() {
    if (!currentSession) return;
    
    try {
        const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${SHEETS_CONFIG.SPREADSHEET_ID}/values/${SHEETS_CONFIG.RANGE}?key=${SHEETS_CONFIG.API_KEY}`
        );
        
        if (response.ok) {
            const data = await response.json();
            if (data.values) {
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
                const sessionRows = data.values.filter(row => row[0] === currentSession);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                sessionData.players = {};
                sessionData.votes = {};
                
                sessionRows.forEach(row => {
                    const [session, playerId, playerName, vote, task, revealed] = row;
                    
                    sessionData.players[playerId] = {
                        id: playerId,
                        name: playerName,
                        vote: vote ? JSON.parse(vote) : null
                    };
                    
                    if (vote && vote !== 'null') {
                        sessionData.votes[playerId] = {
                            playerName,
                            vote: JSON.parse(vote),
                            timestamp: Date.now()
                        };
                    }
                    
                    if (task) sessionData.task = task;
                    if (revealed) sessionData.isRevealed = revealed === 'true';
                });
                
                updatePlayersDisplay();
                if (sessionData.isRevealed) {
                    showResults();
                }
            }
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∏–∑ Sheets:', error);
        // Fallback –∫ localStorage
        // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ localStorage
    }
}
```

## –®–∞–≥ 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ø–æ–¥ —Ä–∞–∑–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
3. –ü—Ä–æ–≥–æ–ª–æ—Å—É–π—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Google Sheets

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets

–¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
- A: Session ID
- B: Player ID  
- C: Player Name
- D: Vote (JSON)
- E: Task Description
- F: Is Revealed (boolean)

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ö–≤–æ—Ç—ã API**: Google Sheets API –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**: –ù–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ–Ω–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: API –∫–ª—é—á –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –≤ –∫–æ–¥–µ. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

–ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets API —Å–ª–æ–∂–Ω–∞, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:
1. **Firebase Realtime Database** - –ø—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
2. **WebRTC** - –ø—Ä—è–º–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏
3. **WebSocket —Å–µ—Ä–≤–µ—Ä** - –µ—Å–ª–∏ –º–æ–∂–µ—Ç–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–µ—Ä
4. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ localStorage (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "API key not valid"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Sheets API –≤–∫–ª—é—á–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API –∫–ª—é—á–∞

### –û—à–∏–±–∫–∞ "The caller does not have permission"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∏–º–µ–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ

### –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "scrum-poker")
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—à–∏–±–æ–∫

---

**–£–¥–∞—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏! üöÄ**